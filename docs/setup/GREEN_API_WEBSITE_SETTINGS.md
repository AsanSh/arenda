# ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Green API - –ß—Ç–æ –≤–∫–ª—é—á–∏—Ç—å

## üî¥ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–∫–ª—é—á–∏—Ç—å:

### 1. Webhook URL
–í –ø–æ–ª–µ **"Webhook Url"** —É–∫–∞–∂–∏—Ç–µ:
```
http://assetmanagement.team/api/webhooks/greenapi/incoming/
```

### 2. –í—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–ö–†–ò–¢–ò–ß–ù–û!)
–í–∫–ª—é—á–∏—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å:
‚úÖ **"Receive webhooks on incoming messages and files"**

–≠—Ç–æ —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ! –ë–µ–∑ —ç—Ç–æ–≥–æ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

## üü° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∫–ª—é—á–∏—Ç—å:

### 3. –°—Ç–∞—Ç—É—Å—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
‚úÖ **"Receive webhooks on sent messages statuses"**

–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

### 4. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚úÖ **"Receive webhooks on change of the account authorization state"**

–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è WhatsApp –∞–∫–∫–∞—É–Ω—Ç–∞.

## ‚ö™ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –≤—ã–∫–ª—é—á–µ–Ω–Ω—ã–º–∏):

- "Receive webhooks on messages sent from phone" - –Ω–µ –Ω—É–∂–Ω–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- "Receive webhooks on messages sent from API" - –Ω–µ –Ω—É–∂–Ω–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- "Get notifications about deleted messages" - –Ω–µ –Ω—É–∂–Ω–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- "Get notifications about edited messages" - –Ω–µ –Ω—É–∂–Ω–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- "Get notifications about incoming chat blocks" - –Ω–µ –Ω—É–∂–Ω–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- "Get notifications about surveys" - –Ω–µ –Ω—É–∂–Ω–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- "Get notifications about calls" - –Ω–µ –Ω—É–∂–Ω–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## üìã –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç:

- [ ] Webhook URL —É–∫–∞–∑–∞–Ω: `http://assetmanagement.team/api/webhooks/greenapi/incoming/`
- [ ] ‚úÖ –í–∫–ª—é—á–µ–Ω–æ: "Receive webhooks on incoming messages and files"
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚úÖ –í–∫–ª—é—á–µ–Ω–æ: "Receive webhooks on sent messages statuses"
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚úÖ –í–∫–ª—é—á–µ–Ω–æ: "Receive webhooks on change of the account authorization state"
- [ ] –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –∏–ª–∏ "Save"

## ‚úÖ –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. –û—Ç–∫—Ä–æ–π—Ç–µ `http://assetmanagement.team/login`
3. –û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ WhatsApp
5. –í—Ö–æ–¥ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ —É—Å–ø–µ—à–Ω–æ!

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è webhook, –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ WhatsApp —Å —Ç–µ–∫—Å—Ç–æ–º "AMT LOGIN <attemptId>", –≤ –ª–æ–≥–∞—Ö backend –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞–ø–∏—Å–∏:

```bash
docker compose logs backend | grep -i webhook
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∏:
- `Webhook received: attemptId=..., senderPhone=...`
- `Login verified: attemptId=..., userId=..., role=...`
- `Login completed: attemptId=..., userId=..., role=...`
